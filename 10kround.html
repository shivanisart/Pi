<!DOCTYPE html>
<html>
<head>
  <title>10,000 Pi Digits - Tight Spiral</title>
  <style>
    body {
      margin: 0;
      background: black;
    }
    canvas {
      display: block;
      margin: auto;
      background: black;
    }
  </style>
</head>
<body>
<canvas id="piCanvas" width="800" height="800"></canvas>

<script>
  const canvas = document.getElementById("piCanvas");
  const ctx = canvas.getContext("2d");

  const pixelSize = 4; // Size of each digit square
  const centerX = Math.floor(canvas.width / 2 / pixelSize);
  const centerY = Math.floor(canvas.height / 2 / pixelSize);

  fetch('10000pi.txt')
    .then(res => res.text())
    .then(text => {
      const digits = text.replace(/\D/g, '').slice(0, 10000);
      drawTightSpiral(digits);
    });

  function drawTightSpiral(digits) {
    const grid = new Map();

    let x = centerX;
    let y = centerY;

    let dx = 1;
    let dy = 0;
    let steps = 1;
    let stepCount = 0;
    let directionChanges = 0;
    let index = 0;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    while (index < digits.length) {
      const digit = parseInt(digits[index]);
      const red = Math.round(255 * (9 - digit) / 9);
      const blue = Math.round(255 * digit / 9);
      ctx.fillStyle = `rgb(${red}, 0, ${blue})`;
      ctx.fillRect(x * pixelSize, y * pixelSize, pixelSize, pixelSize);

      x += dx;
      y += dy;
      stepCount++;
      index++;

      if (stepCount === steps) {
        stepCount = 0;
        directionChanges++;

        // Rotate direction: right → up → left → down → repeat
        [dx, dy] = [-dy, dx];

        // Increase steps every 2 turns
        if (directionChanges % 2 === 0) steps++;
      }
    }
  }
</script>
</body>
</html>
